<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Reportar problema</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS (CDN oficial) -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  >

  <style>
    body { background:#f7f7f8; }
    .card { border-radius: 14px; }
    .honeypot { position:absolute; left:-5000px; opacity:0; height:0; width:0; }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-7">
        <div class="card shadow-sm">
          <div class="card-body p-4">
            <h1 class="h4 mb-3">Reportar problema</h1>
            <p class="text-muted mb-4">
              Descreva o que aconteceu. Geraremos um protocolo e um link para você acompanhar o status.
            </p>

            <form id="issueForm" action="reportar.php" method="post" novalidate>
              <!-- Honeypot anti-spam (deixe em branco) -->
              <input type="text" name="website" class="honeypot" tabindex="-1" autocomplete="off">

              <div class="mb-3">
                <label for="contato" class="form-label">Seu contato (e-mail ou telefone)</label>
                <input type="text" class="form-control" id="contato" name="contato" required
                       placeholder="seuemail@exemplo.com">
                <div class="invalid-feedback">Informe um e-mail ou telefone para contato.</div>
              </div>

              <div class="mb-3">
                <label for="titulo" class="form-label">Título do problema</label>
                <input type="text" class="form-control" id="titulo" name="titulo" required
                       placeholder="Ex.: Erro ao salvar projeto">
                <div class="invalid-feedback">Dê um título curto para o problema.</div>
              </div>

              <div class="row g-3">
                <div class="col-sm-6">
                  <label for="severidade" class="form-label">Severidade</label>
                  <select id="severidade" name="severidade" class="form-select">
                    <option value="baixa">Baixa</option>
                    <option value="média">Média</option>
                    <option value="alta">Alta</option>
                  </select>
                </div>
              </div>

              <div class="mb-3 mt-3">
                <label for="descricao" class="form-label">Descrição</label>
                <textarea class="form-control" id="descricao" name="descricao" rows="6" required
                          placeholder="O que você esperava que acontecesse? O que ocorreu? Passos para reproduzir?"></textarea>
                <div class="invalid-feedback">Descreva o problema para podermos reproduzir.</div>
              </div>

              <!-- Dica: se quiser usar reCAPTCHA/Turnstile, insira o widget aqui. -->

              <div class="d-grid gap-2 d-sm-flex justify-content-sm-end">
                <button id="btnEnviar" type="submit" class="btn btn-primary px-4">
                  Enviar
                </button>
                <button type="reset" class="btn btn-outline-secondary">Limpar</button>
              </div>

              <p class="text-muted small mt-3 mb-0">
                Ao enviar, será gerado um link de acompanhamento (protocolo) para você acompanhar o andamento e comentar.
              </p>
            </form>
          </div>
        </div>

        <div class="text-center mt-4">
          <a class="text-decoration-none" href="track.php"
             onclick="event.preventDefault(); alert('Use o link gerado após o envio para acompanhar seu chamado.');">
            Acompanhar chamado
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (opcional, para alguns componentes) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <script>
    // Validação Bootstrap + prevenção de envio duplo + honeypot
    const form = document.getElementById('issueForm');
    const btn = document.getElementById('btnEnviar');

    form.addEventListener('submit', function (e) {
      // Honeypot: se preenchido, bloqueia
      if (form.website && form.website.value.trim() !== '') {
        e.preventDefault();
        alert('Falha no envio.');
        return;
      }

      if (!form.checkValidity()) {
        e.preventDefault();
        e.stopPropagation();
      } else {
        // Evita cliques repetidos
        btn.disabled = true;
        btn.textContent = 'Enviando...';
      }
      form.classList.add('was-validated');
    }, false);
  </script>
</body>
</html>
